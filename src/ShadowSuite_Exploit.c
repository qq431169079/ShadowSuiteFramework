/* Shadow Suite :: Ethical Hacking Toolkit
 * Copyright (C) 2017  Shadow Team <Public.ShadowTeam@gmail.com>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include "ShadowLib.h"

void backdoor_factory(void)
{
    clr();
    prn_logo();
    //DEV0001: Code the wrapper script!
    system("cd $PWD/tools/exploitation/backdoorfactory && bash backdoorfactory-wrapper");
    system("cd ../../..");
}

void brutal(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/brutal && bash Brutal.sh");
    system("cd ../../..");
}

void cge(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/cge && perl cge.pl");
    readline(); //DEV0001: Remove this if automatic exit of program is absent.
    system("cd ../../..");
}

void exploitdb(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/exploitdb && python2 exploitdb.py");
    readline(); //DEV0001: Remove if automatic exit of progran is absent.
    system("cd ../../..");
}

void les(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/les && bash les-wrapper");
    system("cd ../../..");
}

void msf(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/msf/src && ruby msfconsole");
    readline(); //DEV0001: Remove if automatic exit of program is absent.
    system("cd ,./../..");
}

void routersploit(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/routersploit && python2 rsf.py");
    system("cd ../../..");
}

void shellshocker(void)
{
    clr();
    prn_logo();
    system("cd $PWD/tools/exploitation/shellshocker && bash shellshocker.sh");
    system("cd ../../..");
}

void exploithelp(void)
{
    clr();
    color_green();
    prn_logo();
    //DEV0002: Update this when a new explpitation tool is added.
    printf("\n==EXPLOITATION TOOLS INFO==\n\n---------------------------------\n\n");
    printf("Backdoor Factory: Patch executable binaries with user desired shellcode and continue normal execution of the prepatched state.\n\n");
    printf("Brutal: Toolkit to quickly create various payload, powershell attack, virus attack and launch listener for a Human Interface Device.\n\n");
    printf("Cisco Global Exploiter: Exploit the most dangerous vulnerabilities of Cisco systems.\n\n");
    printf("Exploit Database: Search exploit-db.com exploits.\n\n");
    printf("Linux Exploit Suggester: Linux Exploit Suggester; based on operating system release number.\n\n");
    printf("Metasploit Framework: Create various payload for malicious attacks.\n\n");
    printf("RouterSploit: Exploitation framework dedicated to embedded devices.\n\n");
    printf("ShellShocker: Test a list of hosts for the shellshock vulnerability.\n\n");
    printf("\nPress enter to continue...\n\n");
    readline();
}

void exploitSection(void)
{
    int exploitSectionInput;

    clr();
    color_green();
    prn_logo();
    //DEV0002: Update this when a new exploitation tool is added.
    printf("\n==EXPLOITATION TOOLS==\n\n---------------------------------\n\n");
    printf("[01] Backdoor Factory\n[02] Brutal\n[03] Cisco Global Exploiter\n[04] Exploit Database\n[05] Linux Exploit Suggester\n[06] Metasploit Framework\n[07] RouterSploit\n[08] ShellShocker\n\n[98] Info\n[99] Back\n");
    scanf("\n%d", &exploitSectionInput);
    switch (exploitSectionInput)
    {
        case 1:
		backdoor_factory();
		break;

	case 2:
		brutal();
		break;

	case 3:
		cge();
		break;

	case 4:
		exploitdb();
		break;

	case 5:
		les();
		break;

	case 6:
		msf();
		break;

	case 7:
		routersploit();
		break;

	case 8:
		shellshocker();
		break;

	case 98:
		exploithelp();
		break;

	case 99:
		break;

	default:
		prn_invalidinput();
		break;
    }
}
